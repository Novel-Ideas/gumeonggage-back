<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.novelidea.gumeonggage.repository.SalesMapper">

    <resultMap id="SalesResultMap" type="com.novelidea.gumeonggage.entity.Sales">
        <result property="month" column="month" />
        <result property="orderCount" column="order_count" />
        <result property="totalSales" column="total_sales" />
    </resultMap>

    <select id="getSales" resultMap="SalesResultMap">
        select
            DATE_FORMAT(order_time,'%m') as month,
            sum(menu_price_total) as total_sales,
            (select count(distinct order_list_id) from m_sales) as order_count
        from
            m_sales
        where
            DATE_FORMAT(order_time,'%m') = #{month}
        group by
            month;
    </select>

</mapper>